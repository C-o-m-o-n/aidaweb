<!-- Some important info 
from flask import Flask, request, jsonify, render_template, redirect
import cohere
import markdown2  # for converting markdown to HTML
import dotenv
import os
import random   # for randomizing id for characters

# Load the environment variables from the .env file
dotenv.load_dotenv()

# Create a new Cohere client
client = cohere.Client(os.getenv("CKEY"))

app = Flask(__name__)

# Dictionary to store conversations
conversations = {}

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/new_conv', methods=['POST'])
def new_conv():
    # Generate a new conversation ID
    conv_id = str(random.randint(100000, 999999))
    # Initialize the conversation in the dictionary
    conversations[conv_id] = []
    return jsonify({'conv_id': conv_id})

@app.route('/chat', methods=['POST'])
def chat():
    data = request.json
    message = data['message']
    conv_id = data['conv_id']
    chat_history = conversations[conv_id]
    chat_history.append({"role": "USER", "message": message})  # Add user message to history

    # Send the updated chat history
    response = client.chat(message=message, 
                            chat_history=chat_history,
                            temperature=0.5, max_tokens=150)
    response = response.text
    chat_history.append({"role": "ASSISTANT", "message": response})  # Add assistant response to history
    
    # Convert markdown response to HTML
    html_response = markdown2.markdown(response, extras=["tables"])

    return jsonify({'raw_response': response, 'html_response': html_response, 'chat_history': chat_history})

@app.route('/auth/discord')
def auth_discord():
    return render_template('logintest.html')

@app.route('/auth/discord/callback')
def auth_discord_callback():
    return render_template('basicinfolist.html')

if __name__ == '__main__':
    app.run(debug=False)

-->

<!--
    <!DOCTYPE html>
<html>
<head>
  <title>Login With Discord (test)</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div class="login-btn">
    <a href="https://discord.com/oauth2/authorize?client_id=1155512630627270727&response_type=token&redirect_uri=http%3A%2F%2Flocalhost%3A5000%2Fauth%2Fdiscord%2Fcallback&scope=identify+guilds+guilds.members.read">
      <img src="https://seeklogo.com/images/D/discord-logo-7A1EC3216C-seeklogo.com.png" alt="Login With Discord">
    </a>
</html>
-->

<!-- This page is the callback one and uses the token-->
<!DOCTYPE html>
<html>
<head>
  <title>Basic Info List</title>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div class="basic-info-list">
    <h1>Basic Information List</h1>
    <ul>
      <li>Username: </li>
      <li><img id='pfp'></li>

    <div class="logout-btn">
        <a href="/logout">Logout</a>    
    </div>
    <script>
        const urlParams = new URLSearchParams(window.location.hash.substr(1));
        const token = urlParams.get('access_token');
        console.log(token);
        fetch('https://discord.com/api/users/@me', {
            headers: {
                'Authorization': `Bearer ${token}`
            }
        })
        .then(response => response.json())
        .then(data => {
            console.log(data);
            document.querySelector('li').textContent = `Username: ${data.username}#${data.discriminator}`;
            document.getElementById('pfp').src = `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png`;
        })
        .catch(error => console.error('Error:', error));
    </script>
</body>
</html>